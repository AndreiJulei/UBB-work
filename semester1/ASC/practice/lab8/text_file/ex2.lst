     1                                  bits 32 ; assembling for the 32 bits architecture
     2                                  
     3                                  ; declare the EntryPoint (a label defining the very first instruction of the program)
     4                                  global start        
     5                                  
     6                                  ; declare external functions needed by our program
     7                                  extern exit               ; tell nasm that exit exists even if we won't be defining it
     8                                  import exit msvcrt.dll    ; exit is a function that ends the calling process. It is defined in msvcrt.dll
     9                                                            ; msvcrt.dll contains exit, printf and all the other important C-runtime specific functions
    10                                  
    11                                  extern fopen, fprintf, fclose, fread,printf,scanf
    12                                  import fopen msvcrt.dll
    13                                  import fprintf msvcrt.dll
    14                                  import fclose msvcrt.dll
    15                                  import fread msvcrt.dll
    16                                  import printf msvcrt.dll
    17                                  import scanf msvcrt.dll
    18                                  
    19                                  ; our data is declared here (the variables needed by our program)
    20                                  segment data use32 class=data
    21                                      ; ...
    22                                  	;1. se citesc din fisire caractere pana la caracterul '+', sa se afiseze in console nr de litere mici 
    23                                  	;urmat de nr de cifre citite
    24                                  	;2. se citeste de la tastatura un nr de fisier input.txt si un caracter 'a' fisierul input.txt contine cuvinte separate prin #, sa se scrie in output.txt doar cuvintele in care apare caracterul 'a' doar pe pozitia 
    25 00000000 7200000000000000        	acces_read dd 'r',0
    26 00000008 <res 00000064>          	buffer resb 100
    27 0000006C 696E7075742E747874-     	file_name dd "input.txt",0
    27 00000075 00000000000000     
    28 0000007C 00000000                	nr_litere_mici dd 0
    29 00000080 00000000                	nr_cifre dd 0
    30 00000084 2564000000000000        	output_format dd '%d',0
    31 0000008C 00000000                	id dd 0
    32 00000090 2000000000000000        	space dd " ",0
    33                                  	
    34                                  	
    35                                  	
    36                                  ; our code starts here
    37                                  segment code use32 class=code
    38                                      start:
    39                                          ; ...
    40 00000000 68[00000000]            		push acces_read
    41 00000005 68[6C000000]            		push file_name
    42 0000000A FF15[00000000]          		call [fopen]
    43                                  		
    44 00000010 A3[8C000000]            		mov [id],eax
    45 00000015 833D[8C000000]00        		cmp dword[id],0
    46 0000001C 0F8481000000            		jz final
    47                                  		
    48 00000022 BE00000000              		mov esi,0
    49                                  		
    50                                  		
    51 00000027 50                      		push eax
    52 00000028 6A64                    		push 100
    53 0000002A 6A01                    		push 1
    54 0000002C 68[08000000]            		push buffer	
    55 00000031 FF15[00000000]          		call [fread]
    56                                  			
    57                                  			numara_caractere:
    58 00000037 8A86[08000000]          				mov al,[buffer+esi]
    59 0000003D 3C61                    				cmp al,'a'
    60 0000003F 7C0A                    				jl next
    61 00000041 3C7A                    				cmp al,'z'
    62 00000043 7F06                    				jg next
    63 00000045 FF05[7C000000]          				inc dword [nr_litere_mici]
    64                                  				
    65                                  				next :
    66 0000004B 3C30                    				cmp al,'0'
    67 0000004D 7C0A                    				jl increment
    68 0000004F 3C39                    				cmp al,'9'
    69 00000051 7F06                    				jg increment
    70 00000053 FF05[80000000]          				inc dword [nr_cifre]
    71                                  				
    72                                  				increment:
    73 00000059 46                      				inc esi
    74 0000005A 3C00                    				cmp al,0
    75 0000005C 75D9                    			jnz numara_caractere
    76                                  		
    77 0000005E FF35[8C000000]          		push dword [id]
    78 00000064 FF15[00000000]          		call [fclose]
    79 0000006A 83C404                  		add esp,4
    80                                  		
    81 0000006D FF35[7C000000]          		push dword [nr_litere_mici]
    82 00000073 68[84000000]            		push dword output_format
    83 00000078 FF15[00000000]          		call [printf]
    84 0000007E 83C408                  		add esp,4*2
    85                                  		
    86 00000081 68[90000000]            		push dword space
    87 00000086 FF15[00000000]          		call [printf]
    88 0000008C 83C404                  		add esp,4
    89                                  		
    90 0000008F FF35[80000000]          		push dword [nr_cifre]
    91 00000095 68[84000000]            		push dword output_format
    92 0000009A FF15[00000000]          		call [printf]
    93 000000A0 83C408                  		add esp,4*2
    94                                  		
    95                                  	
    96                                  		final:
    97                                          ; exit(0)
    98 000000A3 6A00                            push    dword 0      ; push the parameter for exit onto the stack
    99 000000A5 FF15[00000000]                  call    [exit]       ; call exit to terminate the program
